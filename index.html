<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Man Utd</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>
    <script src="API-football-data.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <!--Header-->
    <section id="header">

        <a id="navbar" href="index.html"><img src="Images/ManchesterUnitedLogo.png" width="80px" height="80px"
                class="Logo" alt="Team Logo"></a>
        <div>
            <ul id="navbar">
                <li><a class="active" href="index.html">Home</a></li>
                <li><a href="Shop.html">Shop</a></li>
                <li><a href="Tickets.html">Tickets</a></li>
                <li><a href="News.html">News</a></li>
                <li><a href="Players.html">Players</a></li>
                <li><a href="About.html">About</a></li>
                <li><a href="SignIn.html"><img src="Images/ProfileDefault.png" width="30px" height="30px"
                            alt="Profile Logo"></a></li>
            </ul>
        </div>

    </section>
    <!--Start page, video + header text-->
    <div id="welcome">
        <video autoplay loop muted plays-inline class="back-video">
            <source src="Videos/manu.mp4" type="video/mp4">
        </video>
    </div>
    <div id="intro">
        <h4>Welcome to the official website of</h4>
        <h1>Manchester United</h1>
    </div>
    <br>
    <section>
        <div id="breakbar"></div>
    </section>
    <section>
        <div id="matchestext">
            <h2 id="headertext"> Matches</h2>
            <span><a class="see-more" href="News.html">View More</a></span>
        </div>
        <!--Demo of fixtures-->
        <div id="scrollpane"></div>

        <div id="shopdemo">

            <div id="Image-slide-in">
                <img src="Images/Home-Shop-AD/3.png" alt="Picture of Player">
            </div>
            <div id="visit-now">
                <a href="Shop.html" id="shop-now">Visit Shop</a>
            </div>

        </div>
        <!--Players section-->
        <div class="top-players-cards">
            <h1 class="top-header">Top Performing Players</h1>
            <div class="cards-container" id="cardsContainer">

            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="footer-col">
                    <h4>Account</h4>
                    <ul>
                        <li><a id="login-footer" href="SignIn.html">Login</a></li>
                        <li><a id="login-footer" href="SignIn.html">Sign up</a></li>
                        <li><a href="#">privacy policy</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Accessibility</h4>
                    <ul>
                        <li><a href="#">FAQ</a></li>
                        <li><a href="About.html">History</a></li>
                        <li><a href="About.html">Old Trafford</a></li>
                        <li><a href="About.html">Legends</a></li>
                        <li><a href="More.html">Matches</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>online shop</h4>
                    <ul>
                        <li><a href="Tickets.html">Tickets</a></li>
                        <li><a href="Shop.html">Merch</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>follow us</h4>
                    <div class="social-links">
                        <a href="https://www.facebook.com/manchesterunited"><i class="fa-brands fa-facebook"></i></a>
                        <a href="https://twitter.com/ManUtd"><i class="fa-brands fa-x"></i></a>
                        <a href="http://instagram.com/manchesterunited"><i class="fa-brands fa-instagram"></i></a>
                        <a href="https://www.youtube.com/manutd"><i class="fa-brands fa-youtube"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        fetch("https://v3.football.api-sports.io/fixtures?season=2023&team=33", {
            "method": "GET",
            "headers": {
                "x-rapidapi-host": "v3.football.api-sports.io",
                "x-rapidapi-key": "19ca6ef50amshb9e9bbbc427749ap1b1644jsn062d3ee"
            }
        })
            .then(response => response.json())
            .then(data => {
                const scrollpane = document.getElementById('scrollpane');

                const upcomingMatches = data.response.filter(matchData => {
                    const matchDate = new Date(matchData.fixture.date);
                    const currentTime = new Date();
                    return matchDate > currentTime || matchData.fixture.status.short === '1H' || matchData.fixture.status.short === '2H' || matchData.fixture.status.short === 'ET';
                }).sort((a, b) => new Date(a.fixture.date) - new Date(b.fixture.date));

                upcomingMatches.forEach(matchData => {
                    const containerMatch = createContainerMatch(matchData);
                    scrollpane.appendChild(containerMatch);
                });
            })
            .catch(error => console.error('Error fetching data:', error));

        function createContainerMatch(matchData) {
            const containerMatch = document.createElement('div');
            containerMatch.classList.add('container-match');

            const card = document.createElement('div');
            card.classList.add('card');

            const cardTitle = document.createElement('div');
            cardTitle.classList.add('card_title');

            const h1 = document.createElement('h1');
            h1.textContent = 'Upcoming Match';
            cardTitle.appendChild(h1);

            const matchLocation = document.createElement('p');
            matchLocation.id = 'match_type';
            matchLocation.textContent = matchData.fixture.venue.name;
            cardTitle.appendChild(matchLocation);

            const matchInfo = document.createElement('div');
            matchInfo.classList.add('match_info');

            const teamName = document.createElement('div');
            teamName.classList.add('team_name');

            const homeTeamDiv = createTeamDiv(matchData.teams.home, "team1");
            const awayTeamDiv = createTeamDiv(matchData.teams.away, "team2");

            teamName.appendChild(homeTeamDiv);
            teamName.appendChild(awayTeamDiv);

            const vs = document.createElement('div');
            vs.classList.add('vs');
            vs.innerHTML = '<p>vs</p>';

            const dateTime = document.createElement('div');
            dateTime.classList.add('date_time');
            dateTime.innerHTML = `<p>${new Date(matchData.fixture.date).toLocaleDateString()}</p>
                                    <p>${new Date(matchData.fixture.date).toLocaleTimeString()}</p>`;

            matchInfo.appendChild(teamName);
            matchInfo.appendChild(vs);
            matchInfo.appendChild(dateTime);

            const seeDetails = document.createElement('div');
            seeDetails.classList.add('seeDetails');

            if (matchData.fixture.status.short === 'NS') {
                const infoButtonDiv = document.createElement('div');
                infoButtonDiv.classList.add('info-button');
                const infoButton = document.createElement('a');
                infoButton.id = 'match-button';
                infoButton.href = 'Tickets.html';
                infoButton.tabIndex = '0';
                infoButton.textContent = 'BUY TICKETS';
                infoButtonDiv.appendChild(infoButton);
                seeDetails.appendChild(infoButtonDiv);
            } else {
                const timeNumber = document.createElement('span');
                timeNumber.id = 'timeNumber';
                timeNumber.textContent = matchData.goals.home + " - " + matchData.goals.away + "\t" + matchData.fixture.status.elapsed;
                const livetimeanimation = document.createElement('span');
                livetimeanimation.id = 'livetimeanimation';
                livetimeanimation.textContent = "'";
                timeNumber.appendChild(livetimeanimation);
                seeDetails.appendChild(timeNumber);
            }

            card.appendChild(cardTitle);
            card.appendChild(matchInfo);
            card.appendChild(seeDetails);

            containerMatch.appendChild(card);

            return containerMatch;
        }


        function createTeamDiv(team, teamNum) {
            const teamDiv = document.createElement('div');
            teamDiv.classList.add(teamNum);

            const teamLogo = document.createElement('img');
            teamLogo.src = team.logo;
            teamLogo.alt = '';

            const teamName = document.createElement('h3');
            teamName.textContent = team.name;

            teamDiv.appendChild(teamLogo);
            teamDiv.appendChild(teamName);

            return teamDiv;
        }


        function fetchTopPlayers() {
            fetch('https://v3.football.api-sports.io/players?league=39&season=2023&team=33&page=2', {
                "method": "GET",
                "headers": {
                    "x-rapidapi-host": "v3.football.api-sports.io",
                    "x-rapidapi-key": "19ca6ef50amshb9e9bbbc427749ap1b1644jsn062d3ee"
                }
            }).then(response => response.json())
                .then(data => {
                    const topPlayers = data.response;

                    topPlayers.sort((a, b) => parseFloat(b.statistics[0].games.rating) - parseFloat(a.statistics[0].games.rating));

                    const cardsContainer = document.getElementById('cardsContainer');
                    for (let i = 0; i < 4; i++) {
                        const player = topPlayers[i].player;
                        const rating = parseFloat(topPlayers[i].statistics[0].games.rating).toFixed(2);
                        const age = new Date().getFullYear() - new Date(player.birth.date).getFullYear();
                        const playerId = player.id;
                        const imageUrl = `Images/Players/${playerId}.png`;

                        const minip = document.createElement('div');
                        minip.classList.add('minip');

                        const mg = document.createElement('div');
                        mg.classList.add('mg');

                        const clr = document.createElement('div');
                        clr.classList.add('clr');

                        const group = document.createElement('div');
                        group.classList.add('group');

                        const span = document.createElement('span');

                        const av = document.createElement('div');
                        av.classList.add('av');
                        av.style.backgroundImage = `url('${imageUrl}')`;

                        const info = document.createElement('div');
                        info.classList.add('info');

                        const name = document.createElement('name');
                        name.innerText = player.name;

                        const deets = document.createElement('deets');
                        deets.innerHTML = `Age: ${age}<br>Rating: ${rating}`;

                        group.appendChild(span);
                        mg.appendChild(clr);
                        mg.appendChild(group);
                        minip.appendChild(mg);
                        minip.appendChild(av);
                        info.appendChild(name);
                        info.appendChild(deets);
                        minip.appendChild(info);

                        cardsContainer.appendChild(minip);
                    }
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
        }

        fetchTopPlayers();
    </script>
</body>






</html>