<!DOCTYPE html>
<html lang="<%= lang %>">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Man Utd Home Page</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="/js/script.js"></script>
    <script src="/js/API-football-data.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <!--Header-->
    <%- include('../partials/header', { user: user }) %>
        <!--Start page, video + header text-->
        <div id="welcome">
            <video autoplay loop muted plays-inline class="back-video">
                <source src="/videos/manu.mp4" type="video/mp4">
            </video>
        </div>
        <div id="intro">
            <h1>Manchester United</h1>
        </div>
        <br>
        <section>
            <div id="breakbar"></div>
        </section>
        <section>
            <div id="matchestext">
                <h2 id="headertext"><%= __('recent') %> <%= __('matches') %></h2>
                <span><a class="see-more" href="/Fixtures"><%= __('view') %> <%= __('more') %></a></span>
            </div>

            <div id="scrollpane"></div>

            <div id="shopdemo">

                <div id="Image-slide-in">
                    <img src="/images/Home-Shop-AD/5.png" alt="Picture of Player">
                </div>
                <div id="visit-now">
                    <a href="/Shop" id="shop-now"><%= __('visit') %> <%= __('shop') %></a>

                </div>

            </div>
            <!--Players section-->
            <div class="top-players-cards">
                <h1 class="top-header">
                    <%= __('top') %> <%= __('performing') %> <%= __('players') %>
                </h1>   
                <div class="cards-container" id="cardsContainer">
                        <!-- Example cards to mimic the data generated by fetchTopPlayers -->
                        <div class="minip">
                            <div class="av" style="background-image: url('Images/Players/74.png');"></div>
                            <div class="info">
                                <div class="name">Player 1</div>
                                <div class="deets">Age: 28<br>Rating: 8.5</div>
                            </div>
                        </div>
                        <div class="minip">
                            <div class="av" style="background-image: url('Images/Players/74.png');"></div>
                            <div class="info">
                                <div class="name">Player 2</div>
                                <div class="deets">Age: 25<br>Rating: 8.2</div>
                            </div>
                        </div>
                        <div class="minip">
                            <div class="av" style="background-image: url('Images/Players/74.png');"></div>
                            <div class="info">
                                <div class="name">Player 3</div>
                                <div class="deets">Age: 30<br>Rating: 8.0</div>
                            </div>
                        </div>
                        <div class="minip">
                            <div class="av" style="background-image: url('Images/Players/74.png');"></div>
                            <div class="info">
                                <div class="name">Player 4</div>
                                <div class="deets">Age: 27<br>Rating: 7.8</div>
                            </div>
                        </div>
                </div>
            </div>
        </section>
        <script>
            // fetch("https://v3.football.api-sports.io/fixtures?season=2023&team=33", {
            //     "method": "GET",
            //     "headers": {
            //         "x-rapidapi-host": "v3.football.api-sports.io",
            //         "x-rapidapi-key": "19ca6ef50amshb9e9bbbc427749ap1b1644jsn062d3ee"
            //     }
            // })
            //     .then(response => response.json())
            //     .then(data => {
            //         const scrollpane = document.getElementById('scrollpane');

            //         const upcomingMatches = data.response.filter(matchData => {
            //             const matchDate = new Date(matchData.fixture.date);
            //             const currentTime = new Date();
            //             return matchDate > currentTime || matchData.fixture.status.short === '1H' || matchData.fixture.status.short === '2H' || matchData.fixture.status.short === 'ET';
            //         }).sort((a, b) => new Date(a.fixture.date) - new Date(b.fixture.date));

            //         upcomingMatches.forEach(matchData => {
            //             const containerMatch = createContainerMatch(matchData);
            //             scrollpane.appendChild(containerMatch);
            //         });
            //     })
            //     .catch(error => console.error('Error fetching data:', error));

            // function createContainerMatch(matchData) {
            //     const containerMatch = document.createElement('div');
            //     containerMatch.classList.add('container-match');

            //     const card = document.createElement('div');
            //     card.classList.add('card');

            //     const cardTitle = document.createElement('div');
            //     cardTitle.classList.add('card_title');

            //     const h1 = document.createElement('h1');
            //     h1.textContent = 'Upcoming Match';
            //     cardTitle.appendChild(h1);

            //     const matchLocation = document.createElement('p');
            //     matchLocation.id = 'match_type';
            //     matchLocation.textContent = matchData.fixture.venue.name;
            //     cardTitle.appendChild(matchLocation);

            //     const matchInfo = document.createElement('div');
            //     matchInfo.classList.add('match_info');

            //     const teamName = document.createElement('div');
            //     teamName.classList.add('team_name');

            //     const homeTeamDiv = createTeamDiv(matchData.teams.home, "team1");
            //     const awayTeamDiv = createTeamDiv(matchData.teams.away, "team2");

            //     teamName.appendChild(homeTeamDiv);
            //     teamName.appendChild(awayTeamDiv);

            //     const vs = document.createElement('div');
            //     vs.classList.add('vs');
            //     vs.innerHTML = '<p>vs</p>';

            //     const dateTime = document.createElement('div');
            //     dateTime.classList.add('date_time');
            //     dateTime.innerHTML = `<p>${new Date(matchData.fixture.date).toLocaleDateString()}</p>
            //                         <p>${new Date(matchData.fixture.date).toLocaleTimeString()}</p>`;

            //     matchInfo.appendChild(teamName);
            //     matchInfo.appendChild(vs);
            //     matchInfo.appendChild(dateTime);

            //     const seeDetails = document.createElement('div');
            //     seeDetails.classList.add('seeDetails');

            //     if (matchData.fixture.status.short === 'NS') {
            //         const infoButtonDiv = document.createElement('div');
            //         infoButtonDiv.classList.add('info-button');
            //         const infoButton = document.createElement('a');
            //         infoButton.id = 'match-button';
            //         infoButton.href = 'Tickets.html';
            //         infoButton.tabIndex = '0';
            //         infoButton.textContent = 'BUY TICKETS';
            //         infoButtonDiv.appendChild(infoButton);
            //         seeDetails.appendChild(infoButtonDiv);
            //     } else {
            //         const timeNumber = document.createElement('span');
            //         timeNumber.id = 'timeNumber';
            //         timeNumber.textContent = matchData.goals.home + " - " + matchData.goals.away + "\t" + matchData.fixture.status.elapsed;
            //         const livetimeanimation = document.createElement('span');
            //         livetimeanimation.id = 'livetimeanimation';
            //         livetimeanimation.textContent = "'";
            //         timeNumber.appendChild(livetimeanimation);
            //         seeDetails.appendChild(timeNumber);
            //     }

            //     card.appendChild(cardTitle);
            //     card.appendChild(matchInfo);
            //     card.appendChild(seeDetails);

            //     containerMatch.appendChild(card);

            //     return containerMatch;
            // }


            // function createTeamDiv(team, teamNum) {
            //     const teamDiv = document.createElement('div');
            //     teamDiv.classList.add(teamNum);

            //     const teamLogo = document.createElement('img');
            //     teamLogo.src = team.logo;
            //     teamLogo.alt = '';

            //     const teamName = document.createElement('h3');
            //     teamName.textContent = team.name;

            //     teamDiv.appendChild(teamLogo);
            //     teamDiv.appendChild(teamName);

            //     return teamDiv;
            // }






            // The Working API Code Starts from down here.

            // function fetchTopPlayers() {
            //     fetch('https://v3.football.api-sports.io/players?league=39&season=2023&team=33&page=2', {
            //         "method": "GET",
            //         "headers": {
            //             "x-rapidapi-host": "v3.football.api-sports.io",
            //             "x-rapidapi-key": "86bfe4c0932d846ff80b0cae2adbe19a"
            //         }
            //     }).then(response => response.json())
            //         .then(data => {
            //             const players = data.response;

            //             const filteredPlayers = players.filter(player => {
            //                 const rating = player.statistics[0].games.rating;
            //                 return rating !== null && !isNaN(parseFloat(rating));
            //             });

            //             filteredPlayers.sort((a, b) => parseFloat(b.statistics[0].games.rating) - parseFloat(a.statistics[0].games.rating));

            //             const topPlayers = filteredPlayers.slice(0, 4);

            //             const cardsContainer = document.getElementById('cardsContainer');
            //             cardsContainer.innerHTML = '';

            //             topPlayers.forEach(playerData => {
            //                 const player = playerData.player;
            //                 const rating = parseFloat(playerData.statistics[0].games.rating).toFixed(2);
            //                 const age = new Date().getFullYear() - new Date(player.birth.date).getFullYear();
            //                 const playerId = player.id;
            //                 const imageUrl = `Images/Players/${playerId}.png`;

            //                 const minip = document.createElement('div');
            //                 minip.classList.add('minip');

            //                 const mg = document.createElement('div');
            //                 mg.classList.add('mg');

            //                 const clr = document.createElement('div');
            //                 clr.classList.add('clr');

            //                 const group = document.createElement('div');
            //                 group.classList.add('group');

            //                 const span = document.createElement('span');

            //                 const av = document.createElement('div');
            //                 av.classList.add('av');
            //                 av.style.backgroundImage = `url('${imageUrl}')`;

            //                 const info = document.createElement('div');
            //                 info.classList.add('info');

            //                 const name = document.createElement('name');
            //                 name.innerText = player.name;

            //                 const deets = document.createElement('deets');
            //                 deets.innerHTML = `Age: ${age}<br>Rating: ${rating}`;

            //                 group.appendChild(span);
            //                 mg.appendChild(clr);
            //                 mg.appendChild(group);
            //                 minip.appendChild(mg);
            //                 minip.appendChild(av);
            //                 info.appendChild(name);
            //                 info.appendChild(deets);
            //                 minip.appendChild(info);

            //                 cardsContainer.appendChild(minip);
            //             });
            //         })
            //         .catch(error => {
            //             console.error('Error fetching data:', error);
            //         });
            // }





            // function fetchRecentMatches() {
            //     fetch("https://v3.football.api-sports.io/fixtures?season=2023&team=33", {
            //         "method": "GET",
            //         "headers": {
            //             "x-rapidapi-host": "v3.football.api-sports.io",
            //             "x-rapidapi-key": "86bfe4c0932d846ff80b0cae2adbe19a"
            //         }
            //     })
            //         .then(response => response.json())
            //         .then(data => {
            //             const matches = data.response;

            //             // Sort matches by date in descending order
            //             matches.sort((a, b) => new Date(b.fixture.date) - new Date(a.fixture.date));

            //             // Select the most recent five matches
            //             const recentMatches = matches.slice(0, 5);

            //             const scrollpane = document.getElementById('scrollpane');
            //             scrollpane.innerHTML = ''; // Clear any existing content

            //             recentMatches.forEach(match => {
            //                 const containerMatch = createContainerMatch(match);
            //                 scrollpane.appendChild(containerMatch);
            //             });
            //         })
            //         .catch(error => console.error('Error fetching data:', error));
            // }

            // function createContainerMatch(matchData) {
            //     const containerMatch = document.createElement('div');
            //     containerMatch.classList.add('container-match');

            //     const card = document.createElement('div');
            //     card.classList.add('card');

            //     const cardTitle = document.createElement('div');
            //     cardTitle.classList.add('card_title');

            //     const h1 = document.createElement('h1');
            //     if (matchData.fixture.status.long === 'Match Finished') {
            //         h1.textContent = 'Match finished';
            //     } else if (matchData.fixture.status.short === 'NS') {
            //         h1.textContent = 'Upcoming Match';
            //     } else {
            //         h1.textContent = 'Live Match';
            //     }
            //     cardTitle.appendChild(h1);

            //     const matchLocation = document.createElement('p');
            //     matchLocation.id = 'match_type';
            //     matchLocation.textContent = matchData.fixture.venue.name;
            //     cardTitle.appendChild(matchLocation);

            //     const matchInfo = document.createElement('div');
            //     matchInfo.classList.add('match_info');

            //     const teamName = document.createElement('div');
            //     teamName.classList.add('team_name');

            //     const homeTeamDiv = createTeamDiv(matchData.teams.home, "team1");
            //     const awayTeamDiv = createTeamDiv(matchData.teams.away, "team2");

            //     teamName.appendChild(homeTeamDiv);
            //     teamName.appendChild(awayTeamDiv);

            //     const vs = document.createElement('div');
            //     vs.classList.add('vs');
            //     vs.innerHTML = '<p>vs</p>';

            //     const dateTime = document.createElement('div');
            //     dateTime.classList.add('date_time');
            //     dateTime.innerHTML = `<p>${new Date(matchData.fixture.date).toLocaleDateString()}</p>
            //               <p>${new Date(matchData.fixture.date).toLocaleTimeString()}</p>`;

            //     matchInfo.appendChild(teamName);
            //     matchInfo.appendChild(vs);
            //     matchInfo.appendChild(dateTime);

            //     const seeDetails = document.createElement('div');
            //     seeDetails.classList.add('seeDetails');

            //     if (matchData.fixture.status.long === 'Match Finished') {
            //         const timeNumber = document.createElement('span');
            //         timeNumber.id = 'timeNumber';
            //         timeNumber.textContent = matchData.goals.home + " - " + matchData.goals.away + " FT";
            //         seeDetails.appendChild(timeNumber);
            //     } else if (matchData.fixture.status.short === 'NS') {
            //         const infoButtonDiv = document.createElement('div');
            //         infoButtonDiv.classList.add('info-button');
            //         const infoButton = document.createElement('a');
            //         infoButton.id = 'match-button';
            //         infoButton.href = 'Tickets.html';
            //         infoButton.tabIndex = '0';
            //         infoButton.textContent = 'BUY TICKETS';
            //         infoButtonDiv.appendChild(infoButton);
            //         seeDetails.appendChild(infoButtonDiv);
            //     } else {
            //         const timeNumber = document.createElement('span');
            //         timeNumber.id = 'timeNumber';
            //         timeNumber.textContent = matchData.goals.home + " - " + matchData.goals.away + "\t" + matchData.fixture.status.elapsed;
            //         const livetimeanimation = document.createElement('span');
            //         livetimeanimation.id = 'livetimeanimation';
            //         livetimeanimation.textContent = "'";
            //         timeNumber.appendChild(livetimeanimation);
            //         seeDetails.appendChild(timeNumber);
            //     }

            //     card.appendChild(cardTitle);
            //     card.appendChild(matchInfo);
            //     card.appendChild(seeDetails);

            //     containerMatch.appendChild(card);

            //     return containerMatch;
            // }

            // function createTeamDiv(team, teamNum) {
            //     const teamDiv = document.createElement('div');
            //     teamDiv.classList.add(teamNum);

            //     const teamLogo = document.createElement('img');
            //     teamLogo.src = team.logo;
            //     teamLogo.alt = '';

            //     const teamName = document.createElement('h3');
            //     teamName.textContent = team.name;

            //     teamDiv.appendChild(teamLogo);
            //     teamDiv.appendChild(teamName);

            //     return teamDiv;
            // }




            // fetchTopPlayers();
            // fetchRecentMatches();

        </script>

        <%- include('../partials/footer') %>

</body>

</html>