<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Man Utd Players</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="/js/script.js"></script>
    <script src="/js/API-football-data.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>

    <%- include('../partials/header', { user: user }) %>

        <section id="players">
            <h1 class="top-header" style="font-size: 5em;">The Red Devils</h1>
            <hr>
            <div class="top-players-cards">
                <h2 id="headertext" style="font-size: 3em;"> Goalkeepers</h2>
                <div class="cards-container" id="gk-cardsContainer">

                </div>
            </div>
            <div class="top-players-cards">
                <h2 id="headertext" style="font-size: 3em;"> Defenders</h2>
                <div class="cards-container" id="def-cardsContainer">

                </div>
            </div>
            <div class="top-players-cards">
                <h2 id="headertext" style="font-size: 3em;"> Midfielders</h2>
                <div class="cards-container" id="mid-cardsContainer">

                </div>
            </div>
            <div class="top-players-cards">
                <h2 id="headertext" style="font-size: 3em;"> Attackers</h2>
                <div class="cards-container" id="att-cardsContainer">

                </div>
            </div>
            <div class="top-players-cards">
                <h2 id="headertext" style="font-size: 3em;"> Head coach</h2>
                <div class="cards-container" id="coach-cardsContainer">

                </div>
            </div>
        </section>
        <script>
            function fetchAllPlayers() {
                fetch('https://v3.football.api-sports.io/players/squads?team=33', {
                    "method": "GET",
                    "headers": {
                        "x-rapidapi-host": "v3.football.api-sports.io",
                        "x-rapidapi-key": "86bfe4c0932d846ff80b0cae2adbe19a"
                    }
                }).then(response => response.json())
                    .then(data => {
                        const players = data.response[0].players;
                        fetchGoalkeepers(players);
                        fetchDefenders(players);
                        fetchMidfielders(players);
                        fetchAttackers(players);
                    })
                    .catch(error => {
                        console.error('Error fetching data:', error);
                    });
            }
    
    
    
    
    
    
    
            // Fetch goalkeepers
            function fetchGoalkeepers(players) {
    
                const goalkeepers = players.filter(player => player.position === "Goalkeeper");
    
                const cardsContainer = document.getElementById('gk-cardsContainer');
                for (let i = 0; i < goalkeepers.length; i++) {
                    const player = goalkeepers[i];
                    const age = player.age;
                    const playerId = player.id;
                    const imageUrl = `Images/Players/${playerId}.png`;
    
                    const minip = document.createElement('div');
                    minip.classList.add('minip');
    
                    const mg = document.createElement('div');
                    mg.classList.add('mg');
    
                    const clr = document.createElement('div');
                    clr.classList.add('clr');
    
                    const group = document.createElement('div');
                    group.classList.add('group');
    
                    const span = document.createElement('span');
    
                    const av = document.createElement('div');
                    av.classList.add('av');
                    av.style.backgroundImage = `url('${imageUrl}')`;
    
                    const info = document.createElement('div');
                    info.classList.add('info');
    
                    const name = document.createElement('name');
                    name.innerText = player.name;
    
                    const deets = document.createElement('deets');
                    deets.innerHTML = `Age: ${age}<br>number: ${player.number}`;
    
                    group.appendChild(span);
                    mg.appendChild(clr);
                    mg.appendChild(group);
                    minip.appendChild(mg);
                    minip.appendChild(av);
                    info.appendChild(name);
                    info.appendChild(deets);
                    minip.appendChild(info);
    
                    cardsContainer.appendChild(minip);
                }
            }
    
    
    
    
            // Fetch defenders
            function fetchDefenders(players) {
    
                const defenders = players.filter(player => player.position === "Defender");
    
                const cardsContainer = document.getElementById('def-cardsContainer');
                for (let i = 0; i < defenders.length; i++) {
                    const player = defenders[i];
                    const age = player.age;
                    const playerId = player.id;
                    const imageUrl = `Images/Players/${playerId}.png`;
    
                    const minip = document.createElement('div');
                    minip.classList.add('minip');
    
                    const mg = document.createElement('div');
                    mg.classList.add('mg');
    
                    const clr = document.createElement('div');
                    clr.classList.add('clr');
    
                    const group = document.createElement('div');
                    group.classList.add('group');
    
                    const span = document.createElement('span');
    
                    const av = document.createElement('div');
                    av.classList.add('av');
                    av.style.backgroundImage = `url('${imageUrl}')`;
    
                    const info = document.createElement('div');
                    info.classList.add('info');
    
                    const name = document.createElement('name');
                    name.innerText = player.name;
    
                    const deets = document.createElement('deets');
                    deets.innerHTML = `Age: ${age}<br>number: ${player.number}`;
    
                    group.appendChild(span);
                    mg.appendChild(clr);
                    mg.appendChild(group);
                    minip.appendChild(mg);
                    minip.appendChild(av);
                    info.appendChild(name);
                    info.appendChild(deets);
                    minip.appendChild(info);
    
                    cardsContainer.appendChild(minip);
                }
    
            }
    
    
    
    
            // Fetch Midfielders
            function fetchMidfielders(players) {
    
                const midfielders = players.filter(player => player.position === "Midfielder");
    
                const cardsContainer = document.getElementById('mid-cardsContainer');
                for (let i = 0; i < midfielders.length; i++) {
                    const player = midfielders[i];
                    const age = player.age;
                    const playerId = player.id;
                    const imageUrl = `Images/Players/${playerId}.png`;
    
                    const minip = document.createElement('div');
                    minip.classList.add('minip');
    
                    const mg = document.createElement('div');
                    mg.classList.add('mg');
    
                    const clr = document.createElement('div');
                    clr.classList.add('clr');
    
                    const group = document.createElement('div');
                    group.classList.add('group');
    
                    const span = document.createElement('span');
    
                    const av = document.createElement('div');
                    av.classList.add('av');
                    av.style.backgroundImage = `url('${imageUrl}')`;
    
                    const info = document.createElement('div');
                    info.classList.add('info');
    
                    const name = document.createElement('name');
                    name.innerText = player.name;
    
                    const deets = document.createElement('deets');
                    deets.innerHTML = `Age: ${age}<br>number: ${player.number}`;
    
                    group.appendChild(span);
                    mg.appendChild(clr);
                    mg.appendChild(group);
                    minip.appendChild(mg);
                    minip.appendChild(av);
                    info.appendChild(name);
                    info.appendChild(deets);
                    minip.appendChild(info);
    
                    cardsContainer.appendChild(minip);
                }
    
            }
    
    
    
            // Fetch attackers
            function fetchAttackers(players) {
    
                const attackers = players.filter(player => player.position === "Attacker");
    
                const cardsContainer = document.getElementById('att-cardsContainer');
                for (let i = 0; i < attackers.length; i++) {
                    const player = attackers[i];
                    const age = player.age;
                    const playerId = player.id;
                    const imageUrl = `Images/Players/${playerId}.png`;
    
                    const minip = document.createElement('div');
                    minip.classList.add('minip');
    
                    const mg = document.createElement('div');
                    mg.classList.add('mg');
    
                    const clr = document.createElement('div');
                    clr.classList.add('clr');
    
                    const group = document.createElement('div');
                    group.classList.add('group');
    
                    const span = document.createElement('span');
    
                    const av = document.createElement('div');
                    av.classList.add('av');
                    av.style.backgroundImage = `url('${imageUrl}')`;
    
                    const info = document.createElement('div');
                    info.classList.add('info');
    
                    const name = document.createElement('name');
                    name.innerText = player.name;
    
                    const deets = document.createElement('deets');
                    deets.innerHTML = `Age: ${age}<br>number: ${player.number}`;
    
                    group.appendChild(span);
                    mg.appendChild(clr);
                    mg.appendChild(group);
                    minip.appendChild(mg);
                    minip.appendChild(av);
                    info.appendChild(name);
                    info.appendChild(deets);
                    minip.appendChild(info);
    
                    cardsContainer.appendChild(minip);
                }
    
            }
    
    
    
    
            // Fetch coach
            function fetchCoach() {
                fetch('https://v3.football.api-sports.io/coachs/squads?team=33', {
                    "method": "GET",
                    "headers": {
                        "x-rapidapi-host": "v3.football.api-sports.io",
                        "x-rapidapi-key": "86bfe4c0932d846ff80b0cae2adbe19a"
                    }
                })
                    .then(response => response.json())
                    .then(data => {
                        const coaches = data.response;
    
                        const manUtdCoach = coaches.find(coach => {
                            return coach.team.id == 33 && coach.career[0].end == null;
                        });
    
                        if (manUtdCoach) {
                            const cardsContainer = document.getElementById('coach-cardsContainer');
    
                            const minip = document.createElement('div');
                            minip.classList.add('minip');
    
                            const mg = document.createElement('div');
                            mg.classList.add('mg');
    
                            const clr = document.createElement('div');
                            clr.classList.add('clr');
    
                            const group = document.createElement('div');
                            group.classList.add('group');
    
                            const span = document.createElement('span');
    
                            const av = document.createElement('div');
                            av.classList.add('av');
                            av.style.backgroundImage = `url('Images/Players/${manUtdCoach.id}.png')`;
    
                            const info = document.createElement('div');
                            info.classList.add('info');
    
                            const name = document.createElement('name');
                            name.innerText = `${manUtdCoach.name}`;
    
                            const deets = document.createElement('deets');
                            const startDate = new Date(manUtdCoach.career[0].start).toLocaleDateString('en-US');
                            deets.innerHTML = `Age: ${manUtdCoach.age}<br><br>Date hired: ${startDate}`;
    
                            group.appendChild(span);
                            mg.appendChild(clr);
                            mg.appendChild(group);
                            minip.appendChild(mg);
                            minip.appendChild(av);
                            info.appendChild(name);
                            info.appendChild(deets);
                            minip.appendChild(info);
    
                            cardsContainer.appendChild(minip);
                        } else {
                            console.log('No coach currently managing Manchester United found.');
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching data:', error);
                    });
            }
    
            fetchAllPlayers();
            fetchCoach();
        </script>

        <%- include('../partials/footer') %>

</body>

</html>